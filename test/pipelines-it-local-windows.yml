jobs:
- job: 'Test'

  steps:
  - script: |
      powershell.exe -file install.ps1
    displayName: 'Install nni toolkit via source code'
  - script: |
      python -m pip install scikit-learn==0.20.0 --user
      python -m pip install keras==2.1.6 --user
      python -m pip install tensorflow --user
    displayName: 'Install dependencies for integration tests'
  - script: |
      cd test
      python generate_ts_config.py
    displayName: 'generate config files'
#   - script: |
#       cd test
#       powershell.exe -file unittest.ps1
#     displayName: 'unit test'
#   - script: |
#       cd test
#       python naive_test.py
#     displayName: 'Naive test'
#   - script: |
#       cd test
#       python tuner_test.py
#     displayName: 'Built-in tuners / assessors tests'
#   - script: |
#       cd test
#       python metrics_test.py
#     displayName: 'Trial job metrics test'
  - script: |
      cd test
      python config_test.py --ts local --exclude cifar10,smac,batchtuner
    displayName: 'Examples and advanced features tests on local machine'